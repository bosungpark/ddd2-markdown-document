선점 잠금(비관적 락)
=

선점 잠금을 사용할 때에는 잠금 순서에 따른 교착 상태가 발생하지 않도록 주의해야 한다.

데드락은 이용자가 많을 수록 발생하기 쉽고, 이에 대한 대비로 최대 대기 시간을 설정하는 것이 좋다.



비선점 잠금(낙관적 락)

선점 잠금만으로는 데이터 언싱크 문제에 완벽하게 대응할 수는 없다. 안전 장치가 필요하다.

예를 들어 8-6 예제와 같은 경우, 주문정보를 받아오고, 폼을 통해 데이터 변경을 요청하는 사이에 주문정보의 변경이 있는 경우를 생각할 수 있다.

이런 경우, 낙관적 락을 걸고, 버전 정보를 프론트 단에 보내주에 교차검증하는 방안을 생각할 수 있다.

오프라인 선점 방식
=
오프라인 선점 방식은 여러 트랜잭션에 거쳐 진행된다. 첫 번째 트랜잭션에 락을 걸고, 마지막 트랜잭션에 락을 해제한다. 잠금을 해제하기 이전까지 다른 사용자는 잠금을 구할 수 없다.

역시 영원히 락이 풀리지 않는 문제를 해결하고자 잠금 유효 시간을 설정한다.

